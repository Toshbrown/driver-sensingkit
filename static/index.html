<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Databox Mobile Driver</title>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
	</head>
	<body>
		<div id="ipForm">
			<form action="set-mobile-ip" method="post">
				Mobile Phone IP Address: <input type="text" name="ip"><br>
				<input type="submit">
			</form>
		</div>
		<p id="connect-status"></p>
		<script>
			var updateStatus;
			(updateStatus = function() {
				$.get('is-connected', {}, function(isConnected) {
					if (isConnected === 'true')
						document.getElementById('connect-status').innerText = 'Mobile phone connected.';
					else
						document.getElementById('connect-status').innerText = 'Mobile phone not connected.';
				});
			})();
			$('#ipForm').submit(function(e) {
				$('input[type="submit"]').prop('disabled', true);
				$.ajax({
					type: 'POST',
					url: 'set-mobile-ip',
					data: { ip: $('input[type="text"]').val() },
					success: function(data) {
						updateStatus();
						$('input[type="submit"]').prop('disabled', false);
					}
				});
				e.preventDefault();
			});
		</script>
	</body>
</html>
